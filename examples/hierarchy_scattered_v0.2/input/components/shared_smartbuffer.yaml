compound_components:
  version: 0.2
  classes:
  - name: shared_smartbuffer
    attributes:
      technology: 15
      width: 64
      depth: 512
      n_rdwr_ports: 2
      nbanks: 10
      bank_depth: 224
      bank_width: 16
      n_rd_ports: 2      # number of architectural read ports
      n_wr_ports: 2      # number of architectural write ports
      n_bank_rd_ports: 1
      n_bank_wr_ports: 1

    subcomponents:
      - name: storage_SRAM
        class: shared_SRAM
        attributes:
          nbanks: nbanks
          bank_depth: bank_depth
          bank_width: bank_width
          n_rd_ports: n_rd_ports     # number of architectural read ports
          n_wr_ports: n_wr_ports     # number of architectural write ports
          n_bank_rd_ports: n_bank_rd_ports
          n_bank_wr_ports: n_bank_wr_ports
          n_bank_rdwr_ports: n_bank_wr_ports + n_bank_rd_ports
          technology: technology

      - name: sb_pattern_generator
        class: counter
        attributes:
          datawidth: log2(depth)
          technology: technology

    actions:                    # list of compound actions in the design
      - name: drain             # compound action 0: drain
        arguments:
          address_delta: 0..1
          data_delta: 0..1
          active_banks: 0..n_rd_ports
        subcomponents:
          - name: storage_SRAM
            actions:
              - name: read
                arguments:
                  address_delta: address_delta
                  data_delta: data_delta
                  active_banks: active_banks
          - name: sb_pattern_generator
            actions:
              - name: count

      - name: fill
        arguments:
          address_delta: 0..1
          data_delta: 0..1
          active_banks: 0..n_rd_ports
        subcomponents:
          - name: storage_SRAM
            actions:
              - name: write
                arguments:
                  address_delta: address_delta
                  data_delta: data_delta
                  active_banks: active_banks
          - name: sb_pattern_generator
            actions:
              - name: count

      - name: update
        arguments:
          address_delta: 0..1
          data_delta: 0..1
          active_banks: 0..n_rd_ports
        subcomponents:
          - name: storage_SRAM
            actions:
              - name: write
                arguments:
                  address_delta: address_delta
                  data_delta: data_delta
                  active_banks: active_banks
          - name: sb_pattern_generator
            actions:
              - name: count
